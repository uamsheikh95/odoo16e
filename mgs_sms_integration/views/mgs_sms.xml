<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <record id="inherit_view_account_move_out_form" model="ir.ui.view">
        <field name="name">inherit.view.account.payment.form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_post']" position="after">
                    <button name="send_sms" string="Resend Invoice sms" groups="account.group_account_user" type="object" class="oe_highlight" attrs="{'invisible':['|',('state', '!=', 'posted'),('move_type','!=','out_invoice')]}"/>
                </xpath>

            </field>
        </record>

        
        <record id="inherit_view_account_payment_form" model="ir.ui.view">
            <field name="name">inherit.view.account.payment.form</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">
                    <xpath expr="//button[@name='action_post']" position="after">
                        <button name="send_sms" string="Resend payment sms" groups="account.group_account_user" type="object" class="oe_highlight" attrs="{'invisible': ['|',('state', '!=', 'posted'),('payment_type','!=','inbound')]}"/>
                    </xpath>
                
            </field>
        </record>

        <record id="inherit_view_stock_picking_form" model="ir.ui.view">
            <field name="name">inherit.view.stock.picking.form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                    <xpath expr="//button[@name='button_validate']" position="after">
                        <button name="send_mgs_sms" string="Resend picking sms" groups="account.group_account_user" type="object" class="oe_highlight" attrs="{'invisible': ['|',('state', '!=', 'done'),('picking_type_code', '!=', 'outgoing')]}"/>
                    </xpath>
                
            </field>
        </record>


    <record id="mgs_sms_tree" model="ir.ui.view">
        <field name="name">mgs.sms.tree</field>
        <field name="model">mgs.sms</field>
        <field name="arch" type="xml">
            <tree string="mgs sms">
                <field name="datetime"/>
                <field name="source_name"/>
                <field name="model_id"/>
                <field name="partner_id"/>
                <field name="mobile"/>
                <field name="state" widget="badge" decoration-danger="state == 'failed'" decoration-success=" state=='sent'"/>
            </tree>
        </field>
    </record>

<record id="mgs_sms_form" model="ir.ui.view">
    <field name="name">mgs.sms.form</field>
    <field name="model">mgs.sms</field>
    <field name="arch" type="xml">
        <form string="mgs sms">
            <header>
                <button name="action_send_sms" class="btn btn-primary" type="object" string="SEND SMS"/>

                <field name="state" widget="statusbar" statusbar_visible="sent,failed"/>

            </header>
            <sheet>
                <group>
                        <group>
                            <h1><field name="source_name" readonly="1" /></h1>
                            <field name="datetime" readonly="1"/>
                            <field name="model_id" readonly="1"/>
                        </group>


                        <group>
                            <field name="partner_id" readonly="1"/>
                            <field name="mobile"/>
                        </group>
                </group>

                <group>
                    <field name="response" readonly="1"/>
                </group>
                <notebook>
                    <page name="message" readonly="1" string="Message">
                        <field name="message" readonly="1"/>
                    </page>
                </notebook>
            </sheet>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread" options="{'post_refresh': 'recipients'}"/>
                </div>
        </form>
    </field>
</record>


        <record id="mgs_sms_action" model="ir.actions.act_window">
            <field name="name">SMS LOG</field>
            <field name="res_model">mgs.sms</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'create': False}</field>
        </record>




            <menuitem
                id="mgs_sms_menu"
                name="SMS LOG"
                action="mgs_sms_action"
                parent="mgs_sms_integration_root"
                groups="base.group_no_one"
                sequence="1" />

</odoo>
