<odoo>
    <!-- Accout Payment -->
    <record id="account_balance_payment_from_inherit" model="ir.ui.view">
        <field name="name">account.payment.form.inherit</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="replace">
                <label for="partner_id"/>
                <div class="d-flex">
                    <field name="partner_id" context="{'default_is_company': True}" string="Customer" options="{'no_quick_create': True}" attrs="{'readonly':[('state', '!=', 'draft')],'invisible':['|', ('partner_type','!=','customer'), ('is_internal_transfer', '=', True)]}"/>
                    <field name="partner_id" context="{'default_is_company': True}" string="Vendor" options="{'no_quick_create': True}" attrs="{'readonly':[('state', '!=', 'draft')],'invisible':['|', ('partner_type','!=','supplier'), ('is_internal_transfer', '=', True)]}"/> 
                    <span class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field name="partner_balance"/>
                </div>
            </xpath>

            <xpath expr="//field[@name='journal_id']" position="replace">
                <label for="journal_id"/>
                <div class="d-flex">
                    <field name="journal_id" domain="[('id', 'in', available_journal_ids)]" attrs="{'readonly': [('state', '!=', 'draft')]}"/>                    
                    <span class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field name="account_balance"/>
                </div>
            </xpath>

            <xpath expr="//field[@name='destination_journal_id']" position="replace">
                <label for="destination_journal_id" attrs="{'invisible': [('is_internal_transfer', '=', False)],'readonly': [('state', '!=', 'draft')]}"/>
                <div class="d-flex">
                    <field name="destination_journal_id" context="{'default_partner_id': partner_id}" attrs="{'invisible': [('is_internal_transfer', '=', False)],'readonly': [('state', '!=', 'draft')], 'required': [('is_internal_transfer', '=', True),('state', '=', 'draft')]}"/>
                    <span attrs="{'invisible': [('is_internal_transfer', '=', False)],'readonly': [('state', '!=', 'draft')]}" class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field attrs="{'invisible': [('is_internal_transfer', '=', False)],'readonly': [('state', '!=', 'draft')]}" name="tranfer_account_balance"/>
                </div>
            </xpath>
        </field>
    </record>

    <record id="account_balance_payment_register_from_inherit" model="ir.ui.view">
        <field name="name">account.payment.register.form.inherit</field>
        <field name="model">account.payment.register</field>
        <field name="inherit_id" ref="account.view_account_payment_register_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='journal_id']" position="replace">
                <label for="journal_id"/>
                <div class="d-flex">
                    <field name="journal_id" options="{'no_open': True, 'no_create': True}" required="1"/>                    
                    <span class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field name="account_balance"/>
                </div>
            </xpath>
        </field>
    </record>

    <!-- Accout Move -->
    <record id="account_balance_move_from_inherit" model="ir.ui.view">
        <field name="name">account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="replace">
                <label for="partner_id"/>
                <div class="d-flex">
                    <field name="partner_id" widget="res_partner_many2one" nolabel="1" context="{'res_partner_search_mode': (context.get('default_move_type', 'entry') in ('out_invoice', 'out_refund', 'out_receipt') and 'customer') or (context.get('default_move_type', 'entry') in ('in_invoice', 'in_refund', 'in_receipt') and 'supplier') or False,'show_address': 1, 'default_is_company': True, 'show_vat': True}" domain="[('type', '!=', 'private'), ('company_id', 'in', (False, company_id))]" options="{&quot;always_reload&quot;: True, &quot;no_quick_create&quot;: True}" attrs="{'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}"/>
                    <span class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field name="partner_balance" attrs="{'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}"/>
                </div>
            </xpath>
        </field>
    </record>

     <!-- Sale Order -->
    <record id="account_balance_sale_order_from_inherit" model="ir.ui.view">
        <field name="name">sale.order.form.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="replace">
                <label for="partner_id"/>
                <div class="d-flex">
                    <field name="partner_id" widget="res_partner_many2one" context="{'res_partner_search_mode': 'customer', 'show_address': 1, 'show_vat': True}" options="{&quot;always_reload&quot;: True}"/>
                    <span class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field name="partner_balance"/>
                </div>
            </xpath>
        </field>
    </record>

     <!-- Purchase Order -->
    <record id="account_balance_purchase_order_from_inherit" model="ir.ui.view">
        <field name="name">purchase.order.form.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="replace">
                <label for="partner_id"/>
                <div class="d-flex">
                    <field name="partner_id" widget="res_partner_many2one" context="{'res_partner_search_mode': 'supplier', 'show_vat': True}" placeholder="Name, TIN, Email, or Reference"/>
                    <span class="o_form_label mx-3 oe_edit_only"> Bal: </span>
                    <field name="partner_balance"/>
                </div>
            </xpath>
        </field>
    </record>

    <!-- Invocie -->
    <template id="add_partner_balance_to_invoice" inherit_id="account.document_tax_totals">
        <xpath expr="//tr[@class='border-black o_total']" position="after">
            <!-- <tr class="border-black o_total">
                <td><strong>Previous Balance</strong></td>
                <td class="text-right">
                    <span t-field="o.currency_id.symbol" /> <span t-esc="'{0:,.2f}'.format(o.partner_id.credit-o.amount_total)"/>
                </td>
            </tr> -->

        
            <tr class="border-black o_total">
                <td><strong>New Balance</strong></td>
                <td class="text-right">
                    <span t-field="o.currency_id.symbol" /> <span t-esc="'{0:,.2f}'.format(o.partner_id.credit)"/>
                </td>
            </tr>
        </xpath>
    </template>
</odoo>
